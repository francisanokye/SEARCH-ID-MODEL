
R version 4.4.1 (2024-06-14) -- "Race for Your Life"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(macpan2)
> library(shellpipes)
> library(tidyverse)
> library(ggthemes)
> 
> loadEnvironments()
> 
> n = 170
> 
> calobj = rdsRead("calibrate.rds")
> 
> reporteddata <- rdsRead("reporteddata.rds")
> 
> inc_sim <- mp_trajectory(calobj)
> print(inc_sim)
    matrix time row col     value
1    cases    1   0   0  36.02895
2    cases    2   0   0  10.03477
3    cases    3   0   0  34.52328
4    cases    4   0   0  22.01091
5    cases    5   0   0  38.68571
6    cases    6   0   0  34.05199
7    cases    7   0   0  46.92302
8    cases    8   0   0  47.75328
9    cases    9   0   0  59.36241
10   cases   10   0   0  82.32029
11   cases   11   0   0  97.80794
12   cases   12   0   0 129.08710
13   cases   13   0   0 158.30515
14   cases   14   0   0 204.27940
15   cases   15   0   0 254.30743
16   cases   16   0   0 324.49455
17   cases   17   0   0 406.78154
18   cases   18   0   0 515.96664
19   cases   19   0   0 648.60842
20   cases   20   0   0 819.68153
21   cases   21   0   0 521.66331
22   cases   22   0   0 657.92322
23   cases   23   0   0 545.83096
24   cases   24   0   0 579.21932
25   cases   25   0   0 528.08144
26   cases   26   0   0 527.28838
27   cases   27   0   0 497.78340
28   cases   28   0   0 485.88665
29   cases   29   0   0 464.47941
30   cases   30   0   0 449.42934
31   cases   31   0   0 431.45433
32   cases   32   0   0 415.97499
33   cases   33   0   0 399.81862
34   cases   34   0   0 384.82984
35   cases   35   0   0 369.92309
36   cases   36   0   0 355.72121
37   cases   37   0   0 341.84962
38   cases   38   0   0 328.51420
39   cases   39   0   0 315.58179
40   cases   40   0   0 303.11596
41   cases   41   0   0 291.06514
42   cases   42   0   0 279.44424
43   cases   43   0   0 268.22908
44   cases   44   0   0 257.41787
45   cases   45   0   0 246.99555
46   cases   46   0   0 236.95459
47   cases   47   0   0 227.28297
48   cases   48   0   0 217.97123
49   cases   49   0   0 209.00839
50   cases   50   0   0 200.38443
51   cases   51   0   0 192.08887
52   cases   52   0   0 184.11161
53   cases   53   0   0 176.44250
54   cases   54   0   0 169.07163
55   cases   55   0   0 200.48487
56   cases   56   0   0 192.04943
57   cases   57   0   0 209.70031
58   cases   58   0   0 210.69190
59   cases   59   0   0 223.04716
60   cases   60   0   0 228.34944
61   cases   61   0   0 238.71670
62   cases   62   0   0 246.19075
63   cases   63   0   0 256.00938
64   cases   64   0   0 264.73853
65   cases   65   0   0 274.64055
66   cases   66   0   0 284.23624
67   cases   67   0   0 294.50230
68   cases   68   0   0 304.80293
69   cases   69   0   0 315.55961
70   cases   70   0   0 326.49961
71   cases   71   0   0 337.80450
72   cases   72   0   0 349.35721
73   cases   73   0   0 361.23532
74   cases   74   0   0 373.38784
75   cases   75   0   0 385.84679
76   cases   76   0   0 398.58863
77   cases   77   0   0 411.62482
78   cases   78   0   0 424.94252
79   cases   79   0   0 438.54323
80   cases   80   0   0 452.41748
81   cases   81   0   0 466.56127
82   cases   82   0   0 480.96525
83   cases   83   0   0 495.62167
84   cases   84   0   0 510.51979
85   cases   85   0   0 525.64877
86   cases   86   0   0 540.99573
87   cases   87   0   0 556.54691
88   cases   88   0   0 572.28690
89   cases   89   0   0 588.19904
90   cases   90   0   0 514.39318
91   cases   91   0   0 528.28280
92   cases   92   0   0 492.48682
93   cases   93   0   0 486.30563
94   cases   94   0   0 463.38772
95   cases   95   0   0 450.95145
96   cases   96   0   0 433.02260
97   cases   97   0   0 418.97507
98   cases   98   0   0 403.31220
99   cases   99   0   0 389.25367
100  cases  100   0   0 374.91044
101  cases  101   0   0 361.38395
102  cases  102   0   0 348.02396
103  cases  103   0   0 335.20394
104  cases  104   0   0 322.69771
105  cases  105   0   0 310.62868
106  cases  106   0   0 298.91524
107  cases  107   0   0 287.59479
108  cases  108   0   0 276.63463
109  cases  109   0   0 266.04246
110  cases  110   0   0 255.80196
111  cases  111   0   0 245.91042
112  cases  112   0   0 236.35690
113  cases  113   0   0 227.13501
114  cases  114   0   0 218.23552
115  cases  115   0   0 209.65073
116  cases  116   0   0 201.37195
117  cases  117   0   0 193.39103
118  cases  118   0   0 185.69951
119  cases  119   0   0 178.28915
120  cases  120   0   0 171.15166
121  cases  121   0   0 164.27888
122  cases  122   0   0 157.66269
123  cases  123   0   0 151.29511
124  cases  124   0   0 145.16825
125  cases  125   0   0 139.27438
126  cases  126   0   0 133.60586
127  cases  127   0   0 128.15524
128  cases  128   0   0 122.91518
129  cases  129   0   0 117.87853
130  cases  130   0   0 113.03829
131  cases  131   0   0 108.38761
132  cases  132   0   0 103.91983
133  cases  133   0   0  99.62847
134  cases  134   0   0  95.50718
135  cases  135   0   0  91.54983
136  cases  136   0   0  87.75043
137  cases  137   0   0  84.10318
138  cases  138   0   0  80.60244
139  cases  139   0   0  77.24275
140  cases  140   0   0  74.01881
141  cases  141   0   0  70.92550
142  cases  142   0   0  67.95785
143  cases  143   0   0  65.11106
144  cases  144   0   0  62.38047
145  cases  145   0   0  59.76160
146  cases  146   0   0  57.25011
147  cases  147   0   0  54.84182
148  cases  148   0   0  52.53267
149  cases  149   0   0  50.31876
150  cases  150   0   0  48.19634
151  cases  151   0   0  46.16178
152  cases  152   0   0  44.21157
153  cases  153   0   0  42.34235
154  cases  154   0   0  40.55087
155  cases  155   0   0  38.83400
156  cases  156   0   0  37.18874
157  cases  157   0   0  35.61219
158  cases  158   0   0  34.10157
159  cases  159   0   0  32.65419
160  cases  160   0   0  31.26747
161  cases  161   0   0  29.93894
162  cases  162   0   0  28.66622
163  cases  163   0   0  27.44701
164  cases  164   0   0  26.27911
165  cases  165   0   0  25.16042
166  cases  166   0   0  24.08889
167  cases  167   0   0  23.06258
168  cases  168   0   0  22.07961
169  cases  169   0   0  21.13819
170  cases  170   0   0  20.23658
> 
> beta_changepoints = c(0, 10, 21, 55, 90)
> 
> pp <- (ggplot(data = inc_sim, aes(x = time, y= value))
+         + geom_line(aes(color = matrix))
+ 	+ geom_point(data = reporteddata, aes(x = time, y = value, color = matrix))
+         + geom_vline(aes(xintercept = x), linetype = "dashed", alpha = 0.5, data = data.frame(x = beta_changepoints))
+         + labs(x = "Date (Dec 2021 - June 2022)", y = "Incidence", title = "SEARCHI Model: Incidence Trajectory with Calibrated Params (macpan2)", color = "")
+         + facet_wrap(~matrix, scales = "free")
+         + theme_clean()
+        )
> 
> print(pp)
> 
> 
> 
> 
